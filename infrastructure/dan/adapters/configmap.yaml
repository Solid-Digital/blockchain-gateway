apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    fullName: adapter-prod
    organization: dan
  name: adapter-prod
  namespace: dan2
data:
  config.toml: | 
    [Logger]
      Level = "debug"
      Format = "json"
      HideFName = false
      CallerDepth = 0

    [Pipeline]
      [Pipeline.Trigger]
        Name = "http-trigger"
        Path = "http-trigger.trigger.v0.2.1-beta.1.unchain-staging.so"
        ConfigPath = "/etc/opt/unchain/http-trigger.toml"
        [Pipeline.Trigger.MessageConfig]
          output = "$.{ethereum-action}"

      [[Pipeline.Actions]]
        Name = "ethereum-action"
        Path = "ethereum-action.action.v0.4.0.unchain-staging.so"
        ConfigPath = "/etc/opt/unchain/ethereum-action.toml"
        [Pipeline.Actions.MessageConfig]
          constructorParams = "$.http-trigger.body.constructorParams"
          from = "0x5E5Af7670253D57A1fB1CbFFF19f47318E827CA6"
          function = "$.http-trigger.body.function"
          params = "$.http-trigger.body.params"
          solidity = "$.http-trigger.body.solidity"
          to = "0x70Ef0C62ab5e7cFebA34585eB569DEE54c7336F1"
          type = "callContractFunction"

  http-trigger.toml: |
    [[auth.basicAuth]]
        username = "$BASIC_AUTH_USER"
        password = "$BASIC_AUTH_PASSWORD"
  ethereum-action.toml: |
    [ethereum]
        host = "https://$ETHEREUM_USER:$ETHEREUM_PASSWORD@dan2.private.nodes.unchain.io/v0/node1"
        synchronousMode = false
        gasPrice = 0
        gasLimit = 1000000000000
         
    [[accounts]]
        address = "0x5E5Af7670253D57A1fB1CbFFF19f47318E827CA6"
        privateKey = "$ETHEREUM_PRIVATE_KEY"

    [redis]
        host =     "dan-redis-do-user-2339835-0.a.db.ondigitalocean.com:25061"
        password = "$REDIS_PASSWORD"

    [[contracts]]
        address = "0x70Ef0C62ab5e7cFebA34585eB569DEE54c7336F1"
        abi = '''
        [
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "domainRegistryAddress",
                        "type": "address"
                    }
                ],
                "stateMutability": "nonpayable",
                "type": "constructor"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "agreementID",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "AgreementNullified",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "agreementID",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "role",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "AgreementSigned",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string[][]",
                        "name": "owners",
                        "type": "string[][]"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "DomainCreated",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "val",
                        "type": "bool"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "DomainPrivate",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    }
                ],
                "name": "DomainResetted",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "agreementID",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "DomainTransferred",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "val",
                        "type": "bool"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "DomainVerified",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "status",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    }
                ],
                "name": "FunctionFailed",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "agreementID",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "index",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "vatAmount",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "date",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "fulfilledDate",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "PaymentAdded",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "agreementID",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "index",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "updateType",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "PaymentUpdated",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "agreementID",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "totalAmount",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "vatAmount",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "buyer",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "seller",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "domainShares",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256[][]",
                        "name": "paymentScheme",
                        "type": "uint256[][]"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "PurchaseAgreementCreated",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "agreementID",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "totalAmount",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "vatAmount",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "buyer",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "seller",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256[][]",
                        "name": "paymentScheme",
                        "type": "uint256[][]"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "RentalAgreementCreated",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "string",
                        "name": "agreementID",
                        "type": "string"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "rentalEndDate",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "timestamp",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "RentalAgreementEnded",
                "type": "event"
            },
            {
                "inputs": [],
                "name": "owner",
                "outputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function",
                "constant": true
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string[][]",
                        "name": "_owners",
                        "type": "string[][]"
                    },
                    {
                        "internalType": "bool",
                        "name": "_isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "createDomain",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string[][]",
                        "name": "_owners",
                        "type": "string[][]"
                    },
                    {
                        "internalType": "bool",
                        "name": "_isPrivate",
                        "type": "bool"
                    }
                ],
                "name": "createAndVerifyDomain",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    }
                ],
                "name": "getDomain",
                "outputs": [
                    {
                        "internalType": "string",
                        "name": "",
                        "type": "string"
                    }
                ],
                "stateMutability": "view",
                "type": "function",
                "constant": true
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "bool",
                        "name": "_val",
                        "type": "bool"
                    }
                ],
                "name": "verifyDomain",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "bool",
                        "name": "_val",
                        "type": "bool"
                    }
                ],
                "name": "setDomainPrivacy",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_totalAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_vatAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "string",
                        "name": "_buyer",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_seller",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_domainShares",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256[][]",
                        "name": "_paymentScheme",
                        "type": "uint256[][]"
                    }
                ],
                "name": "createPurchaseAgreement",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_totalAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_vatAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "string",
                        "name": "_buyer",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_seller",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_domainShares",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256[][]",
                        "name": "_paymentScheme",
                        "type": "uint256[][]"
                    }
                ],
                "name": "createAndSignPurchaseAgreement",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_totalAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_vatAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "string",
                        "name": "_buyer",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_seller",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256[][]",
                        "name": "_paymentScheme",
                        "type": "uint256[][]"
                    }
                ],
                "name": "createRentalAgreement",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_totalAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_vatAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "string",
                        "name": "_buyer",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_seller",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256[][]",
                        "name": "_paymentScheme",
                        "type": "uint256[][]"
                    }
                ],
                "name": "createAndSignRentalAgreement",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_rentalEndDate",
                        "type": "uint256"
                    }
                ],
                "name": "endRentalAgreement",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_role",
                        "type": "string"
                    }
                ],
                "name": "signAgreement",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    }
                ],
                "name": "nullifyAgreement",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_index",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_amount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_vatAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_date",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_fulfilledDate",
                        "type": "uint256"
                    }
                ],
                "name": "addPayment",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    },
                    {
                        "internalType": "uint256",
                        "name": "_index",
                        "type": "uint256"
                    },
                    {
                        "internalType": "string",
                        "name": "_type",
                        "type": "string"
                    }
                ],
                "name": "updatePayment",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    }
                ],
                "name": "transferDomain",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_agreementID",
                        "type": "string"
                    },
                    {
                        "internalType": "bool",
                        "name": "_privateTransfer",
                        "type": "bool"
                    }
                ],
                "name": "transferDomain",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_name",
                        "type": "string"
                    }
                ],
                "name": "resetDomain",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            }
        ]
        '''
